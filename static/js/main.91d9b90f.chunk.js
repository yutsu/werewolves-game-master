(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,n){"use strict";n.r(t);var l=n(0),a=n.n(l),r=n(8),i=n.n(r),s=n(2),o=n(6),c=n(4),u=n(3),h=n(1),d=n(5),p={villager:"\u6751\u4eba",werewolf:"\u4eba\u72fc"},m=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleDeleteOptions=n.handleDeleteOptions.bind(Object(h.a)(n)),n.handlePick=n.handlePick.bind(Object(h.a)(n)),n.handleAddOption=n.handleAddOption.bind(Object(h.a)(n)),n.handleDeleteOption=n.handleDeleteOption.bind(Object(h.a)(n)),n.handleSelectRoles=n.handleSelectRoles.bind(Object(h.a)(n)),n.updateNumberOfRoles=n.updateNumberOfRoles.bind(Object(h.a)(n)),n.determineRoles=n.determineRoles.bind(Object(h.a)(n)),n.nightActionRecord=n.nightActionRecord.bind(Object(h.a)(n)),n.handleKilledAtNight=n.handleKilledAtNight.bind(Object(h.a)(n)),n.handleWinningSide=n.handleWinningSide.bind(Object(h.a)(n)),n.mostSuspiciousPlayer=n.mostSuspiciousPlayer.bind(Object(h.a)(n)),n.morningPhase=n.morningPhase.bind(Object(h.a)(n)),n.nightPhase=n.nightPhase.bind(Object(h.a)(n)),n.nextPlayer=n.nextPlayer.bind(Object(h.a)(n)),n.exile=n.exile.bind(Object(h.a)(n)),n.restart=n.restart.bind(Object(h.a)(n)),n.state={players:[],players_selected:!1,players_with_roles:[],role_determined:!1,phase:"night",possible_roles:["villager","werewolf","seer","knight"],n_each_role:{villager:0,werewolf:0,seer:0,knight:0},suspected_players:[],current_player_id:0,night_action_to_be_killed:[],to_be_exiled:[]},n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){try{var e=localStorage.getItem("players"),t=JSON.parse(e);t&&this.setState(function(){return{players:t}})}catch(n){}}},{key:"componentDidUpdate",value:function(e,t){if(t.players.length!==this.state.players.length){var n=JSON.stringify(this.state.players);localStorage.setItem("players",n)}}},{key:"componentWillUnmount",value:function(){console.log("componentWillUnmount")}},{key:"handleDeleteOptions",value:function(){this.setState(function(){return{players:[]}})}},{key:"handleDeleteOption",value:function(e){this.setState(function(t){return{players:t.players.filter(function(t){return e!==t})}})}},{key:"handlePick",value:function(){var e=Math.floor(Math.random()*this.state.players.length),t=this.state.players[e];alert(t)}},{key:"handleAddOption",value:function(e){return e?this.state.players.indexOf(e)>-1?"\u3053\u306e\u540d\u524d\u306f\u3059\u3067\u306b\u4f7f\u308f\u308c\u3066\u3044\u307e\u3059\uff61":void this.setState(function(t){return{players:t.players.concat(e)}}):"Enter valid value to add item"}},{key:"handleSelectRoles",value:function(){console.log("select roles"),this.setState(function(){return{players_selected:!0}})}},{key:"updateNumberOfRoles",value:function(e,t){this.setState(function(n){return n.n_each_role[t]=e+e*e*n.n_each_role[t]})}},{key:"determineRoles",value:function(){var e=this;if(this.numberOfPlayers()==this.numberOfSelectedRoles()){this.setState(function(){return{role_determined:!0}});var t,n=[],l=this.state.n_each_role;for(t in l)for(;l[t]>0;)n.push(t),l[t]--;for(var a=n.length-1;a>0;a--){var r=Math.floor(Math.random()*(a+1)),i=[n[r],n[a]];n[a]=i[0],n[r]=i[1]}for(var s=0;s<n.length;s++)"villager"==n[s]&&function(){var t=new P(e.state.players[s],!0,"villager",0,!0);e.setState(function(e){return{players_with_roles:e.players_with_roles.concat(t)}})}(),"werewolf"==n[s]&&function(){var t=new x(e.state.players[s],!0,"werewolf",1,!0);e.setState(function(e){return{players_with_roles:e.players_with_roles.concat(t)}})}(),"seer"==n[s]&&function(){var t=new C(e.state.players[s],!0,"seer",0,!0);e.setState(function(e){return{players_with_roles:e.players_with_roles.concat(t)}})}()}else console.log("n_roles != n_players")}},{key:"nightActionRecord",value:function(e,t,n,l){"villager"==t?this.setState(function(e){return{suspected_players:e.suspected_players.concat(n.name)}}):"werewolf"==t?this.setState(function(e){return{night_action_to_be_killed:e.night_action_to_be_killed.concat(n)}}):console.log("todo"),this.nextPlayer(e,t,n,l)}},{key:"nextPlayer",value:function(e,t,n,l){e<l-1?this.setState(function(e){e.current_player_id++}):(this.setState(function(e){e.current_player_id=0}),this.setState(function(e){e.phase="night_action_completed"}))}},{key:"handleKilledAtNight",value:function(){var e=this.state.night_action_to_be_killed[0];return e.alive=!1,e.name}},{key:"mostSuspiciousPlayer",value:function(e){var t,n={},l=!0,a=!1,r=void 0;try{for(var i,s=this.state.suspected_players[Symbol.iterator]();!(l=(i=s.next()).done);l=!0)(t=i.value)!=e&&(n[t]?n[t]++:n[t]=1)}catch(y){a=!0,r=y}finally{try{l||null==s.return||s.return()}finally{if(a)throw r}}for(var o,c=0,u=0,h=Object.values(n);u<h.length;u++)(o=h[u])>c&&(c=o);for(var d=[],p=0,m=Object.keys(n);p<m.length;p++){var f=m[p];n[f]==c&&d.push(f)}return d}},{key:"exile",value:function(e){e.alive=!1,this.exile2(e.name),this.morningActionCompletedPhase()}},{key:"exile2",value:function(e){this.setState(function(t){return{to_be_exiled:[e]}})}},{key:"morningActionCompletedPhase",value:function(){this.setState(function(e){return{phase:e.phase="morning_action_completed"}})}},{key:"restart",value:function(){console.log("restart"),this.setState(function(){return{players_with_roles:[]}}),this.setState(function(){return{role_determined:!1}}),this.setState(function(){return{phase:"night"}}),this.setState(function(){return{suspected_players:[]}}),this.setState(function(){return{current_player_id:0}}),this.setState(function(){return{night_action_to_be_killed:[]}})}},{key:"numberOfPlayers",value:function(){return this.state.players.length}},{key:"numberOfSelectedRoles",value:function(){return Object.values(this.state.n_each_role).reduce(function(e,t){return e+t},0)}},{key:"numberOfAliveVillagers",value:function(){var e,t=0,n=!0,l=!1,a=void 0;try{for(var r,i=this.state.players_with_roles[Symbol.iterator]();!(n=(r=i.next()).done);n=!0)0==(e=r.value).side&&e.alive&&t++}catch(s){l=!0,a=s}finally{try{n||null==i.return||i.return()}finally{if(l)throw a}}return t}},{key:"numberOfAliveWerewolves",value:function(){var e,t=0,n=!0,l=!1,a=void 0;try{for(var r,i=this.state.players_with_roles[Symbol.iterator]();!(n=(r=i.next()).done);n=!0)1==(e=r.value).side&&e.alive&&t++}catch(s){l=!0,a=s}finally{try{n||null==i.return||i.return()}finally{if(l)throw a}}return t}},{key:"handleWinningSide",value:function(){return this.numberOfAliveVillagers()==this.numberOfAliveWerewolves()?1:0==this.numberOfAliveWerewolves()?0:-1}},{key:"morningPhase",value:function(){this.setState(function(e){e.phase="morning"})}},{key:"nightPhase",value:function(){this.setState(function(e){e.phase="night"})}},{key:"render",value:function(){var e=a.a.createElement("div",null,a.a.createElement(f,{subtitle:"\u30d7\u30ec\u30a4\u30e4\u30fc\u3092\u767b\u9332\u3057\u3066\u304f\u3060\u3055\u3044"}),a.a.createElement(y,{players_selected:this.state.players_selected,hasOptions:this.state.players.length>0,handlePick:this.handlePick}),a.a.createElement(_,{players:this.state.players,handleDeleteOptions:this.handleDeleteOptions,handleDeleteOption:this.handleDeleteOption,players_selected:this.state.players_selected}),a.a.createElement(v,{handleAddOption:this.handleAddOption,players_selected:this.state.players_selected}),a.a.createElement(O,{hasOptions:this.state.players.length>0,handleSelectRoles:this.handleSelectRoles}),this.state.players_selected&&a.a.createElement("p",null,"\u3069\u306e\u5f79\u5272\u3092\u4f7f\u3044\u307e\u3059\u304b?"),a.a.createElement(g,{players_selected:this.state.players_selected,updateNumberOfRoles:this.updateNumberOfRoles,determineRoles:this.determineRoles})),t=a.a.createElement("div",null,a.a.createElement(E,{current_player_id:this.state.current_player_id,players_with_roles:this.state.players_with_roles,nightActionRecord:this.nightActionRecord,nextPlayer:this.nextPlayer})),n=a.a.createElement("div",null,a.a.createElement("p",null,"\u671d\u306b\u306a\u308a\u307e\u3057\u305f\uff61"),a.a.createElement(S,{suspected_players:this.suspected_players,night_action_to_be_killed:this.night_action_to_be_killed,handleKilledAtNight:this.handleKilledAtNight,handleWinningSide:this.handleWinningSide,mostSuspiciousPlayer:this.mostSuspiciousPlayer,morningPhase:this.morningPhase,restart:this.restart})),l=a.a.createElement("div",null,a.a.createElement("p",null,"\u8ffd\u653e\u3059\u308b\u4eba\u3092\u6c7a\u3081\u3066\u304f\u3060\u3055\u3044\uff61"),a.a.createElement(w,{players_with_roles:this.state.players_with_roles,exile:this.exile})),r=a.a.createElement("div",null,a.a.createElement(j,{handleWinningSide:this.handleWinningSide,to_be_exiled:this.state.to_be_exiled,nightPhase:this.nightPhase,restart:this.restart}));return this.state.role_determined?"night"==this.state.phase?t:"night_action_completed"==this.state.phase?n:"morning"==this.state.phase?l:"morning_action_completed"==this.state.phase?r:a.a.createElement("div",null,"else"):e}}]),t}(a.a.Component),f=function(e){return a.a.createElement("div",null,a.a.createElement("h1",null,e.title),e.subtitle&&a.a.createElement("h2",null,e.subtitle))};f.defaultProps={title:"\u4eba\u72fc\u30b2\u30fc\u30e0"};var y=function(e){return e.players_selected?a.a.createElement("div",null):a.a.createElement("div",null,a.a.createElement("button",{onClick:e.handlePick,disabled:!e.hasOptions},"What should I do?"))},_=function(e){return e.players_selected?a.a.createElement("div",null):a.a.createElement("div",null,a.a.createElement("button",{onClick:e.handleDeleteOptions},"Remove All"),0===e.players.length&&a.a.createElement("p",null,"\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\uff61"),e.players.map(function(t){return a.a.createElement(b,{key:t,optionText:t,handleDeleteOption:e.handleDeleteOption})}))},b=function(e){return a.a.createElement("div",null,e.optionText,a.a.createElement("button",{onClick:function(t){e.handleDeleteOption(e.optionText)}},"\u524a\u9664"))},v=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleAddOption=n.handleAddOption.bind(Object(h.a)(n)),n.state={error:void 0},n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"handleAddOption",value:function(e){e.preventDefault();var t=e.target.elements.option.value.trim(),n=this.props.handleAddOption(t);this.setState(function(){return{error:n}}),n||(e.target.elements.option.value="")}},{key:"render",value:function(){return this.props.players_selected?a.a.createElement("div",null):a.a.createElement("div",null,this.state.error&&a.a.createElement("p",null,this.state.error),a.a.createElement("form",{onSubmit:this.handleAddOption},a.a.createElement("input",{type:"text",name:"option"}),a.a.createElement("button",null,"\u8ffd\u52a0\u3059\u308b")))}}]),t}(a.a.Component),O=function(e){return a.a.createElement("div",null,a.a.createElement("button",{disabled:!e.hasOptions,onClick:e.handleSelectRoles},"\u5f79\u5272\u306e\u9078\u629e\u3078"))},g=function(e){return e.players_selected?a.a.createElement("div",null):a.a.createElement("div",null,a.a.createElement(R,{role:"villager",updateNumberOfRoles:e.updateNumberOfRoles}),a.a.createElement(R,{role:"werewolf",updateNumberOfRoles:e.updateNumberOfRoles}),a.a.createElement("button",{onClick:e.determineRoles},"\u6c7a\u5b9a"))},E=function(e){var t=e.players_with_roles[e.current_player_id],n=t.name;return t.alive?a.a.createElement("div",null,a.a.createElement("p",null,n,"\u3055\u3093\u306e\u756a\u3067\u3059\uff61 \u672c\u5f53\u306b",n,"\u3055\u3093\u3067\u3059\u304b?"),a.a.createElement("p",null,n,"\u3055\u3093\u306f",p[t.role],"\u3067\u3059\uff61"),a.a.createElement("p",null,t.action_sentence),a.a.createElement(k,{current_player:t,current_player_id:e.current_player_id,players_with_roles:e.players_with_roles,nightActionRecord:e.nightActionRecord})):a.a.createElement("div",null,a.a.createElement("p",null,n,"\u3055\u3093\u306f\u6b7b\u3093\u3067\u3044\u307e\u3059\uff61"),a.a.createElement("button",{onClick:function(n){e.nextPlayer(e.current_player_id,t.role,t,Object.keys(e.players_with_roles).length)}},"\u6b21\u306e\u30d7\u30ec\u30fc\u30e4\u30fc\u3078"))},k=function(e){return a.a.createElement("div",null,e.players_with_roles.map(function(t){if(t!==e.current_player&&t.alive)return a.a.createElement("button",{key:t.name,onClick:function(n){e.nightActionRecord(e.current_player_id,e.current_player.role,t,Object.keys(e.players_with_roles).length)}},t.name,"\u3055\u3093\u3092\u9078\u3076\uff61")}))},S=function(e){var t=e.handleKilledAtNight(),n=e.handleWinningSide(),l=e.mostSuspiciousPlayer(t);return-1==n?a.a.createElement("div",null,a.a.createElement("p",null,"\u6628\u65e5\u306e\u72a0\u7272\u8005\u306f",t,"\u3055\u3093\u3067\u3059\uff61"),a.a.createElement("p",null,"\u4eca\u3082\u3063\u3068\u3082\u7591\u308f\u308c\u3066\u3044\u308b\u306e\u306f"),l.map(function(e){return a.a.createElement("p",{key:e},e,"\u3055\u3093")}),a.a.createElement("button",{onClick:e.morningPhase},"\u6b21\u3078")):1==n?a.a.createElement("div",null,a.a.createElement("p",null,"\u6628\u65e5\u306e\u72a0\u7272\u8005\u306f",t,"\u3055\u3093\u3067\u3059\uff61"),a.a.createElement("h1",null,"\u4eba\u72fc\u306e\u52dd\u5229!"),a.a.createElement("button",{onClick:e.restart},"\u3082\u30461\u30b2\u30fc\u30e0\u3059\u308b")):0==n?a.a.createElement("div",null,a.a.createElement("p",null,"\u6628\u65e5\u306e\u72a0\u7272\u8005\u306f",t,"\u3055\u3093\u3067\u3059\uff61"),a.a.createElement("h1",null,"\u6751\u4eba\u306e\u52dd\u5229!"),a.a.createElement("button",{onClick:e.restart},"\u3082\u30461\u30b2\u30fc\u30e0\u3059\u308b")):void 0},j=function(e){var t=e.to_be_exiled[0],n=e.handleWinningSide();return-1==n?a.a.createElement("div",null,a.a.createElement("p",null,t,"\u3055\u3093, \u6700\u5f8c\u306b\u907a\u8a00\u3092\u3069\u3046\u305e\uff61"),a.a.createElement("button",{onClick:e.nightPhase},"\u6b21\u3078")):1==n?a.a.createElement("div",null,a.a.createElement("p",null,t,"\u3055\u3093, \u6700\u5f8c\u306b\u907a\u8a00\u3092\u3069\u3046\u305e\uff61"),a.a.createElement("h1",null,"\u4eba\u72fc\u306e\u52dd\u5229!"),a.a.createElement("button",{onClick:e.restart},"\u3082\u30461\u30b2\u30fc\u30e0\u3059\u308b")):0==n?a.a.createElement("div",null,a.a.createElement("p",null,t,"\u3055\u3093, \u6700\u5f8c\u306b\u907a\u8a00\u3092\u3069\u3046\u305e\uff61"),a.a.createElement("h1",null,"\u6751\u4eba\u306e\u52dd\u5229!"),a.a.createElement("button",{onClick:e.restart},"\u3082\u30461\u30b2\u30fc\u30e0\u3059\u308b")):void 0},w=function(e){return a.a.createElement("div",null,e.players_with_roles.map(function(t){if(t.alive)return a.a.createElement("button",{key:t.name,onClick:function(n){e.exile(t)}},t.name,"\u3055\u3093\u3092\u8ffd\u653e")}))},R=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleAddOne=n.handleAddOne.bind(Object(h.a)(n)),n.handleMinusOne=n.handleMinusOne.bind(Object(h.a)(n)),n.handleReset=n.handleReset.bind(Object(h.a)(n)),n.state={count:0},n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"handleAddOne",value:function(){this.props.updateNumberOfRoles(1,this.props.role),this.setState(function(e){return{count:e.count+1}})}},{key:"handleMinusOne",value:function(){var e=this;this.setState(function(t){if(0!==t.count)return e.props.updateNumberOfRoles(-1,e.props.role),{count:t.count-1}})}},{key:"handleReset",value:function(){this.props.updateNumberOfRoles(0,this.props.role),this.setState(function(){return{count:0}})}},{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("p",null,p[this.props.role],":",this.state.count),a.a.createElement("button",{onClick:this.handleAddOne},"+1"),a.a.createElement("button",{onClick:this.handleMinusOne},"-1"),a.a.createElement("button",{onClick:this.handleReset},"reset"))}}]),t}(a.a.Component),A=function e(t,n){Object(s.a)(this,e),this.name=t,this.alive=!0},P=function(e){function t(e,n,l,a,r){var i;return Object(s.a)(this,t),(i=Object(c.a)(this,Object(u.a)(t).call(this,e,n))).role="villager",i.side=0,i.killable=!0,i.action_sentence="\u3082\u3063\u3068\u3082\u7591\u308f\u3057\u3044\u4eba\u3092\u4e00\u4eba\u9078\u3093\u3067\u304f\u3060\u3055\u3044\uff61",i}return Object(d.a)(t,e),t}(A),x=function(e){function t(e,n,l,a,r){var i;return Object(s.a)(this,t),(i=Object(c.a)(this,Object(u.a)(t).call(this,e,n))).role="werewolf",i.side=1,i.killable=!0,i.action_sentence="\u4eca\u6669\u8972\u3046\u4eba\u3092\u6c7a\u3081\u3066\u304f\u3060\u3055\u3044\uff61",i}return Object(d.a)(t,e),t}(A),C=function(e){function t(e,n,l,a,r){var i;return Object(s.a)(this,t),(i=Object(c.a)(this,Object(u.a)(t).call(this,e,n,a))).role="seer",i.killable=!0,i}return Object(d.a)(t,e),t}(P),N=m;i.a.render(a.a.createElement(N,null),document.getElementById("root"))},9:function(e,t,n){e.exports=n(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.91d9b90f.chunk.js.map